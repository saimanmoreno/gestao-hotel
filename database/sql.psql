-- -----------------------------------------------------
-- Thu Jan 16 23:00:45 2020
-- Model: New Model    Version: 1.0
-- -----------------------------------------------------
-- hotel brakutxeu
-- -----------------------------------------------------
-- -----------------------------------------------------



-- -----------------------------------------------------
-- Table funcionario
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS funcionario (
  id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  nome TEXT,
  datanasc DATE,
  cargo TEXT,
  senha TEXT,
  endereco TEXT,
  telefone INTEGER,
  email TEXT);


-- -----------------------------------------------------
-- Table reserva
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS reserva (
  codigo INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  data_reserva DATE,
  status TEXT,
  checkin DATE,
  checkout DATE,
  funcionario_id INTEGER NOT NULL REFERENCES funcionario);


-- -----------------------------------------------------
-- Table hospedagem
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS hospedagem (
  numero INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  quantia REAL,
  reserva_codigo INTEGER NOT NULL REFERENCES reserva ON DELETE CASCADE ON UPDATE CASCADE);


-- -----------------------------------------------------
-- Table pagamento
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS pagamento (
  idpagamento INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  dataPagamento DATE,
  valor INTEGER NOT NULL,
  hospedagem_numero INTEGER NOT NULL REFERENCES hospedagem ON DELETE CASCADE ON UPDATE CASCADE);


-- -----------------------------------------------------
-- Table hospedes
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS hospedes (
  nif INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  nome TEXT,
  nacionalidade TEXT,
  telefone INTEGER,
  email TEXT);


-- -----------------------------------------------------
-- Table tipo
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS tipo (
  codigo INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  nome TEXT,
  num_camas INTEGER,
  descricao TEXT);


-- -----------------------------------------------------
-- Table quarto
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS quarto (
  numero INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  preco REAL,
  tipo_codigo INTEGER NOT NULL REFERENCES tipo ON DELETE CASCADE ON UPDATE CASCADE);


-- -----------------------------------------------------
-- Table limpeza
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS limpeza (
  id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  empregada TEXT);


-- -----------------------------------------------------
-- Table reserva_has_quarto
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS reserva_has_quarto (
  reserva_codigo INTEGER NOT NULL REFERENCES reserva ON DELETE CASCADE ON UPDATE CASCADE,
  quarto_numero INTEGER NOT NULL REFERENCES quarto ON DELETE CASCADE ON UPDATE CASCADE,
  PRIMARY KEY (reserva_codigo, quarto_numero));


-- -----------------------------------------------------
-- Table reserva_has_hospedes
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS reserva_has_hospedes (
  reserva_codigo INTEGER NOT NULL REFERENCES reserva ON DELETE CASCADE ON UPDATE CASCADE,
  hospedes_nif INTEGER NOT NULL REFERENCES hospedes ON DELETE CASCADE ON UPDATE CASCADE,
  PRIMARY KEY (reserva_codigo, hospedes_nif));


-- -----------------------------------------------------
-- Table quarto_has_limpeza
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS quarto_has_limpeza (
  quarto_numero INTEGER NOT NULL REFERENCES quarto ON DELETE CASCADE ON UPDATE CASCADE,
  limpeza_id INTEGER NOT NULL REFERENCES limpeza ON DELETE CASCADE ON UPDATE CASCADE,
  PRIMARY KEY (quarto_numero, limpeza_id));  